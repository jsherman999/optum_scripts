Create a python script called ServerPull.py that will read an already-created Tenable.csv file, generate two json data source files described below for each unique "Resource Name" in the Tenable.csv file, and then merge the Tenable data with the two json files as described below:


The three sources files will be called: ./data/<hostname>_infrared.json, ./data/<hostname>_DeploySched.json, and ./Tenable.csv.

Tenable.csv will be provided in the cwd, and is in the format:

Name,Associated Apps,ID,Category,Environment,Tool Identified,Score,ID Date,Countdown,Tool Initial Detection,Last Authenticated Scan,Last Scan,Status,Known Exploit,Severity,Resource Name,Device Type,Blocked Status,Blocked Date,OS Details,Remediate By,Computer Name,Domain Name,Host Name,Related CVE IDs,Description,Details,Remediation,View in Security Platform

Example data record from Tenable.csv:

AlmaLinux 9 : libarchive (ALSA-2025:14130),UHGWM110-021437,TEN-253520,Alma Linux Local Security Checks,Test,Tenable,9.8,2025-08-24T01:03:37.793Z,-20 days,2025-08-23T06:01:40.488Z,2025-09-16T05:09:54.088Z,2025-09-16T05:09:54.088Z,Open,FALSE,Critical,un000191556,general-purpose,Will Not Be Blocked,N/A,N/A,8/29/2025,un000191556.uhc.com,un000191556.uhc.com,N/A,CVE-2025-5914,'The remote AlmaLinux 9 host has packages installed that are affected by a vulnerability as referenced in the ALSA-2025:14130 advisory.<br>    * libarchive: Double free at archive_read_format_rar_seek_data() in archive_read_support_format_rar.c     (CVE-2025-5914)<br><br>Tenable has extracted the preceding description block directly from the AlmaLinux security advisory.<br><br>Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version number.<br><br>Remote package installed : libarchive-3.5.3-5.el9_6<br>Should be                : libarchive-3.5.3-6.el9_6<br><br><br>Port: 0<br>Protocol: TCP<br>', Remote package installed : libarchive-3.5.3-5.el9_6 Should be                : libarchive-3.5.3-6.el9_6   Port: 0 Protocol: TCP ,"""Update the affected bsdtar, libarchive and / or libarchive-devel packages.""",https://securityplatform.optum.com/appdetails/TENABLE-MANAGED-RED-HAT/undefined/fad8285b9be72646457523654eec0797829785251216b860a3f376c895391c1c


The "Resource Name" in the Tenable.csv file is the key field, and a unique set of hostnames will be taken from this field and used as an input list to generate Infrared and DeplySched data for each hostname.  The fields named "server:" in the DeplySched.json file and named "entity_name" in the Infrared.json file correspond to "Resource Name" in Tenable.csv.

data/<hostname>_infrared.json files will be created by running "seered <hostname> -json > data/<hostname>_Infrared.json".  That file have the following fields that are to be included in the merged .csv, shown with example data:

            "support_stage_std": "STEADY STATE",
            "support_group": "UNIX LINUX - UNIX SERVER (UHT) - SPT",
            "support_stage_src": "STEADY STATE",
            "server_support_model": "Full Support",
            "supported_by": "UHT-UNIX",
            "os_remediation": "CIMS MANAGED OS"

data/<hostname>_DeplySched.json files will be created by running "./pull_deployment_schedule.sh hostname > data/<hostname>_DeplySched.json"

The pull_deployment_schedule.sh script is interactive for password prompting and the ServerPull.py script needs to present any prompts or questions it generates to the runner of ServerPull.py

./Merged.csv records should contain the following fields from the Tenable.csv file:

Tool Identified,ID Date,Tool Initial Detection,Last Authenticated Scan,Status,Known Exploit,Severity,Resource Name,Domain Name,Related CVE IDs,Description,Remediation

Merged.csv sould have the following fields from the <hostname>_DeploySched.json file:

deployment_name,start_date,CurrentStatus,is_opted_out
